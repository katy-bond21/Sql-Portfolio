--Create a table containing data from my goodreads_library
CREATE TABLE goodreads_library
(id serial,
title varchar,
series varchar,
series_number numeric,
author varchar,
my_rating numeric,
avg_rating numeric,
format varchar,
num_pages numeric,
year_published varchar,
org_publication_year varchar,
date_read date,
genre varchar
);

--Import csv file
        COPY goodreads_library
        FROM 'C:\Users\katyb\Desktop\goodreads_library.csv'
        DELIMITER ','
        CSV HEADER;

--Display all books I've rated through Goodreads from highest to lowest rating
SELECT title, author, my_rating, avg_rating 
    FROM  goodreads_library
    ORDER BY my_rating DESC;
    
--Which books did I rate higher than the Goodreads average rating?
SELECT title, author, my_rating, avg_rating 
    FROM goodreads_library
    WHERE my_rating > avg_rating 
    ORDER BY my_rating DESC;
    
--Which books did I rate lower than the Goodreads average rating?
SELECT title, author, avg_rating , my_rating
    FROM goodreads_library
    WHERE my_rating < avg_rating 
    ORDER BY avg_rating  DESC;

--Display table data sorted by genre
SELECT genre, COUNT(*) as by_genre FROM goodreads_library
    GROUP BY genre
    ORDER BY by_genre DESC;

--What is my average rating for each genre?
SELECT genre, AVG(my_rating) as average_rating, COUNT(*) as by_genre FROM goodreads_library
    GROUP BY genre
    ORDER BY average_rating DESC;

